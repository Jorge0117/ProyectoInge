
CREATE TABLE `requests` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `round_start` date NOT NULL,
  `reception_date` date NOT NULL,
  `class_year` year(4) NOT NULL,
  `course_id` char(7) NOT NULL,
  `class_semester` tinyint(4) NOT NULL,
  `class_number` tinyint(4) NOT NULL,
  `student_id` varchar(20) NOT NULL,
  `status` char(1) NOT NULL,
  `another_assistant_hours` tinyint(4) NOT NULL,
  `another_student_hours` tinyint(4) NOT NULL,
  `has_another_hours` tinyint(1) NOT NULL,
  `first_time` tinyint(1) NOT NULL,
  `average` decimal(10,3) NOT NULL,
  `wants_student_hours` tinyint(1) DEFAULT NULL,
  `wants_assistant_hours` tinyint(1) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `student_id` (`student_id`,`course_id`,`class_year`,`class_semester`,`class_number`),
  KEY `ckcourseid` (`course_id`),
  KEY `ck_round_start` (`round_start`),
  CONSTRAINT `ck_round_start` FOREIGN KEY (`round_start`) REFERENCES `rounds` (`start_date`) ON UPDATE CASCADE,
  CONSTRAINT `ckcourseid` FOREIGN KEY (`course_id`) REFERENCES `courses` (`code`)
) ENGINE=InnoDB AUTO_INCREMENT=131 DEFAULT CHARSET=latin1



/*Trigger Para asignarle todos los requerimientos a una solicitud*/
CREATE TRIGGER assign_requirements AFTER INSERT ON requests
FOR EACH ROW
INSERT INTO requests_requirements(requirement_number, request_id) SELECT r.requirement_number,NEW.id  from requirements r;